

\documentclass[useAMS,usenatbib]{mn2e}

% The usenatbib command allows the use of Patrick Daly's natbib.sty for
% cross-referencing.
%
% If you wish to typeset the paper in Times font (if you do not have the
% PostScript Type 1 Computer Modern fonts you will need to do this to get
% smoother fonts in a PDF file) then uncomment the next line
% \usepackage{Times}

%%%%% AUTHORS - PLACE YOUR OWN MACROS HERE %%%%%
\input{abbrev}
\input{psfig.sty}
\usepackage{graphicx}
\usepackage{epsfig}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{txfonts}

\title[{\small}  High Performance P$^{3}$M N-body code: CUBEP3M]{{\small} High Performance P$^{3}$M N-body code: CUBEP3M: }
\author[Joachim Harnois-D\'{e}raps, Ue-Li Pen, Ilian T. Iliev, Hugh Merz]{Joachim Harnois-D\'{e}raps$^{1,2}$ 
\thanks{E-mail: jharno@cita.utoronto.ca},  Ue-Li Pen$^{1}$ \thanks{E-mail: pen@cita.utoronto.ca}, 
Ilian T. Iliev$^{3}$ \thanks{E-mail: i.t.iliev@sussex.ac.uk} and Hugh Merz$^{4}$ \thanks{E-mail: merz@sharcnet.ca}\\
%\footnotemark[1]\thanks{This file has been amended to
%highlight the proper use of \LaTeXe\ code with the class file.
%These changes are for illustrative purposes and do not reflect the
%original paper by A. V. Raveendran.}\\
$^{1}$Canadian Institute for Theoretical Astrophysics, University of
Toronto, M5S 3H8, Canada\\
$^{2}$Department of Physics, University of Toronto, M5S 1A7, Ontario,  Canada\\
$^{3}$Astronomy Centre, Department of Physics and Astronomy, Pevensey II Building, University of Sussex, BN1 9QH, Brighton, United Kingdom\\
$^{4}$Department of XXX}

\begin{document}

%\date{Accepted 1988 December 15. Received 1988 December 14; in original form 1988 October 11}
\date{\today}

\pagerange{\pageref{firstpage}--\pageref{lastpage}} \pubyear{2011}

\maketitle

\label{firstpage}

\begin{abstract}
This paper presents {\small CUBEP3M}, an upgraded version of {\small PMFAST}, 
a two-mesh gravity solver that was already among the fastest N-body codes. 
Among the principal changes, the Poisson solver includes particle-particles interactions
at the sub-grid level and across neighbouring cells, plus each level of the volume decomposition is now cubical.
Force kernel have been improved for enhanced matching of the two mesh contributions near the cutoff length.
We discuss the structure of the code, its accuracy, and its scaling performance.
In addition, many utilities have been added, including a runtime halofinder,
particle identification tags and non-Gaussian initial conditions generator, and we briefly describe their implementation strategy
and accuracy, when applicable . 

\end{abstract}

\begin{keywords}
N-body simulations --- Large scale structure of Universe --- Dark matter
\end{keywords}

\input{Introduction}
\input{Structure}
\input{PoissonSolver}
\input{ScalingPerformance}
\input{Systematics}
\input{Halos}
\input{Extensions}
\input{Conclusion}
%\input{Appendix}
\bibliographystyle{mn2e}
\bibliography{mybib3_new}{}
%\bibliographystyle{amsplain}

\bsp

\label{lastpage}


\end{document}
