

\documentclass[useAMS,usenatbib]{mn2e}

% The usenatbib command allows the use of Patrick Daly's natbib.sty for
% cross-referencing.
%
% If you wish to typeset the paper in Times font (if you do not have the
% PostScript Type 1 Computer Modern fonts you will need to do this to get
% smoother fonts in a PDF file) then uncomment the next line
% \usepackage{Times}

%%%%% AUTHORS - PLACE YOUR OWN MACROS HERE %%%%%
\input{abbrev}
\input{psfig.sty}
\usepackage{graphicx}
\usepackage{epsfig}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{txfonts}

\title[{\small}  High Performance P$^{3}$M N-body code: CUBEP3M]{{\small} High Performance P$^{3}$M N-body code: CUBEP3M}
\author[Joachim Harnois-D\'{e}raps, Ue-Li Pen, Ilian T. Iliev, Hugh Merz, JD Emberson, Vincent Desjacques]{Joachim Harnois-D\'{e}raps$^{1,2}$ 
\thanks{E-mail: jharno@cita.utoronto.ca},  Ue-Li Pen$^{1}$, 
Ilian T. Iliev$^{3}$, Hugh Merz$^{4}$, \newauthor
JD Emberson$^{1,5}$ and Vincent Desjacques$^{6,7}$\\
%\footnotemark[1]\thanks{This file has been amended to
%highlight the proper use of \LaTeXe\ code with the class file.
%These changes are for illustrative purposes and do not reflect the
%original paper by A. V. Raveendran.}\\
$^{1}$Canadian Institute for Theoretical Astrophysics, University of
Toronto, M5S 3H8, Ontario, Canada\\
$^{2}$Department of Physics, University of Toronto, M5S 1A7, Ontario,  Canada\\
$^{3}$Astronomy Centre, Department of Physics and Astronomy, Pevensey II Building, University of Sussex, BN1 9QH, Brighton, United Kingdom\\
$^{4}$SHARCNET, Laurentian University, P3E 2C6, Ontario, Canada\\
$^{5}$Department of Astronomy and Astrophysics, University of Toronto, M5S 3H4, Ontario, Canada\\
$^{6}$Institute for Theoretical Physics, University of Z\"{u}rich, Z\"{u}rich, CH 8057, Switzerland\\
$^{7}$Universit\'{e} de Gen\`{e}ve and Center for Astroparticle Physics, 24 Quai Ernest Ansermet, 1211 Gen\`{e}ve 4, Switzerland}

\begin{document}

%\date{Accepted 1988 December 15. Received 1988 December 14; in original form 1988 October 11}
\date{\today}

\pagerange{\pageref{firstpage}--\pageref{lastpage}} \pubyear{2011}

\maketitle

\label{firstpage}

\begin{abstract}
This paper presents {\small CUBEP3M}, an upgraded version of {\small PMFAST} that
is now one of the fastest highest performance public N-body code. 
Gravity is solved  on a two-level mesh with sub-grid precision due to the particle-particle (pp)
interactions inside and across neighboring cells.
Among important improvements,  {\small CUBEP3M} has a volumetric decomposition,
allowing for a massive parallelization over more than 20,000 cores, and has achieved close to ideal weak scaling
even at this scale.  In addition, force kernels have been improved for enhanced matching of the two mesh contributions near the cutoff length, and the code is now equipped with a unique particle identification tag system that allows reconstruction of individual particle trajectories between time steps.
In parallel, many utilities and extensions have been added to the standard code package, 
including a runtime halo finder, a tuneable range for the exact pp force, a non-Gaussian initial conditions generator, etc.
We discuss the structure, the accuracy, any known systematic effects, and the scaling performance
of the code and its utilities, when applicable {\bf (We should include a density picture somewhere. Ideally a RANGER4000, for which we show the
power spectrum and the halo mass function.)}.
\end{abstract}

\begin{keywords}
N-body simulations --- Large scale structure of Universe --- Dark matter
\end{keywords}

\input{Introduction}
\input{Structure}
\input{PoissonSolver}
\input{ScalingPerformance}
\input{Systematics}
\input{Halos}
\input{Extensions}
\input{Conclusion}
%\input{Appendix}
\bibliographystyle{mn2e}
\bibliography{mybib3_new}{}
%\bibliographystyle{amsplain}

\bsp

\label{lastpage}


\end{document}
